history.forward();var prefix=("https:"==document.location.protocol?"https://":"http://");var getVerifyCodeTimeout;var quickpayConfirmTimeout;function unboundGetVerifyCode(){if(!unboundGetVerifyCodeValidate()){return}var a=$("#bankCode").val();var d=$("#holderName").val();var m=$("#holderType").val();var l=$("#holderId").val();var o=$("#cardNo").val();var p=$("#businessDataBase").val();var b=$("#cardType").val();var e=$("#months").val();var i=$("#years").val();var g=i+e;var k=$("#cvv2").val();var j=$("#phone").val();var f=$("#orderId").val();var h={cardNo:o,cardType:b,holderName:d,holderType:m,holderId:l,validDate:g,phone:j,bankCode:a,cvv2:k,businessDataBase:p};var c=prefix+"quickpay.jd.com/async/asyncGetVerifyCode.action";$("#phoneVerifyCodeTip").html("姝ｅ湪鑾峰彇鎵嬫満楠岃瘉鐮侊紝璇风◢鍊�);getVerifyCodeCountdown(59,0);$.post(c,h,n,"json");function n(q){if(q.result.txnStatus==3){var r={asyncTxnSequenceId:q.result.asyncTxnSequenceId,queryType:1,orderId:f};asyncWait.count=0;asyncWait.setTimer(r,0)}else{if(q.result.txnStatus==1){$("#phoneVerifyCodeTip").html("鐭俊楠岃瘉鐮佸凡鍙戦�鍒版偍鐨勬墜鏈轰笂")}else{if(q.result.showError==2){asyncWait.showPayResult(q.result.txnStatus,q.result.messageCode)}else{if(q.result.showError==1){showErrorTip(q.result.messageText,1)}else{$("#phoneVerifyCodeTip").html("鑾峰彇鎵嬫満楠岃瘉鐮佸け璐ワ紝璇烽噸鏂板彂閫�)}}}}}}
function boundGetVerifyCode(){
	if(!boundGetVerifyCodeValidate()){
		return
		}
	var f=$("#businessDataBase").val();
	var b=$("#cardType").val();
	var e="";
	var h="";
	var a=$("#orderId").val();
	var d={cardNo:e,businessDataBase:f,cvv2:h};
	var c=prefix+"quickpay.jd.com/async/asyncGetVerifyCode.action";
	$("#phoneVerifyCodeTip").html("姝ｅ湪鑾峰彇鎵嬫満楠岃瘉鐮侊紝璇风◢鍊�);" +
			"getVerifyCodeCountdown(59,1);$.post(c,d,g,'json');" +
					"function g(i){" +
					"if(i.result.txnStatus==3){" +
					"var j={asyncTxnSequenceId:i.result.asyncTxnSequenceId,queryType:1,orderId:a};" +
					"asyncWait.count=0;asyncWait.setTimer(j,1)" +
					"}else{if(i.result.txnStatus==1){" +
					"$('#phoneVerifyCodeTip').html('鐭俊楠岃瘉鐮佸凡鍙戦�鍒版偍鐨勬墜鏈轰笂')}else{" +
							"if(i.result.showError==2){asyncWait.showPayResult(i.result.txnStatus,i.result.messageCode)" +
							"}else{if(i.result.showError==1){showErrorTip(i.result.messageText,1)" +
							"}else{$('#phoneVerifyCodeTip').html('鑾峰彇鎵嬫満楠岃瘉鐮佸け璐ワ紝璇烽噸鏂板彂閫�')"}}}}}}
	function unboundQuickpayConfirm(){$("#quickpayConfirmTip").empty();$("#quickpayConfirmTip").css("display","none");if(!unboundQuickpayConfirmValidate()){return}var n=$("#businessDataBase").val();var l=$("#bankCode").val();var q=$("#holderName").val();var a=$("#holderType").val();var m=$("#holderId").val();var k=$("#cardNo").val();var r=$("#cardType").val();var i=$("#months").val();var p=$("#years").val();var j=p+i;var b=$("#cvv2").val();var f=$("#phone").val();var g=$("#token").val();var o=$("#phoneVerifyCode").val();var c=$("#payAgencyCode").val();var h=$("#orderId").val();var s={token:g,cardNo:k,bankCode:l,cvv2:b,holderId:m,holderName:q,holderType:a,phone:f,validDate:j,phoneVerifyCode:o,businessDataBase:n};var d=prefix+"quickpay.jd.com/async/asyncQuickpayConfirm.action";quickpayConfirmCountdown(59,0);$.post(d,s,e,"json");function e(t){if(t.result.txnStatus==3){var u={asyncTxnSequenceId:t.result.asyncTxnSequenceId,queryType:2,orderId:h};asyncWait.count=0;asyncWait.setTimer(u,0)}else{if(t.result.txnStatus==1){asyncWait.showPayResult(t.result.txnStatus,t.result.messageCode)}else{if(t.result.showError==2){asyncWait.showPayResult(t.result.txnStatus,t.result.messageCode)}else{if(t.result.showError==1){showErrorTip(t.result.messageText,2);quickpayConfirmCountdown(0,0)}else{}}}}}}function boundQuickpayConfirm(){$("#quickpayConfirmTip").empty();$("#quickpayConfirmTip").css("display","none");if(!boundQuickpayConfirmValidate()){return}var a=$("#cardType").val();var g=$("#cvv2").val();var d=$("#token").val();var h=$("#phoneVerifyCode").val();var e=$("#validDate").val();var k=$("#businessDataBase").val();var j=$("#payAgencyCode").val();var c=$("#orderId").val();var f={token:d,cvv2:g,phoneVerifyCode:h,businessDataBase:k};var b=prefix+"quickpay.jd.com/async/asyncQuickpayConfirm.action";quickpayConfirmCountdown(59,1);$.post(b,f,i,"json");function i(l){if(l.result.txnStatus==3){var m={asyncTxnSequenceId:l.result.asyncTxnSequenceId,queryType:2,orderId:c};asyncWait.count=0;asyncWait.setTimer(m,1)}else{if(l.result.txnStatus==1){asyncWait.showPayResult(l.result.txnStatus,l.result.messageCode)}else{if(l.result.showError==2){asyncWait.showPayResult(l.result.txnStatus,l.result.messageCode)}else{if(l.result.showError==1){showErrorTip(l.result.messageText,2);quickpayConfirmCountdown(0,1)}else{}}}}}}function autoQueryTxnStatus(){var d=$("#asyncTxnSequenceId").val();if(d==undefined||d=="undefined"||d==""||d==null){return}getVerifyCodeCountdown(59,1);$("#phoneVerifyCodeTip").html("姝ｅ湪鑾峰彇鎵嬫満楠岃瘉鐮侊紝璇风◢鍊�);var a=$("#orderId").val();var b=$("#payAgencyCode").val();var c={asyncTxnSequenceId:d,queryType:1,orderId:a,payAgencyCode:b};asyncWait.count=0;asyncWait.setTimer(c,1)}asyncWait={queryURL:prefix+"quickpay.jd.com/async/asyncQueryTxnStatus.action",timeArray:[1000,5000,9000,10000,15000,20000],count:0,queryRequest:function(b,a){$.post(this.queryURL,b,function(c){if(c.result.txnStatus==3){asyncWait.setTimer(b,a)}else{if(c.result.txnStatus==1){if(b.queryType==1){$("#phoneVerifyCodeTip").html("鐭俊楠岃瘉鐮佸凡鍙戦�鍒版偍鐨勬墜鏈轰笂");$("#token").attr("value",c.result.token);$("#asyncTxnSequenceId").attr("value",c.result.asyncTxnSequenceId)}else{if(b.queryType==2){asyncWait.showPayResult(c.result.txnStatus,c.result.messageCode)}}}else{if(b.queryType==1){if(c.result.showError==2){asyncWait.showPayResult(c.result.txnStatus,c.result.messageCode)}else{if(c.result.showError==1){showErrorTip(c.result.messageText,1)}else{$("#phoneVerifyCodeTip").html("鑾峰彇鎵嬫満楠岃瘉鐮佸け璐ワ紝璇烽噸鏂板彂閫�)}}}else{if(b.queryType==2){if(c.result.showError==2){asyncWait.showPayResult(c.result.txnStatus,c.result.messageCode)}else{if(c.result.showError==1){showErrorTip(c.result.messageText,2);quickpayConfirmCountdown(0,a)}else{}}}}}}},"json")},setTimer:function(b,a){if(this.count<this.timeArray.length){setTimeout(function(){asyncWait.queryRequest(b,a)},this.timeArray[this.count])}this.count++},showPayResult:function(b,a){$("#txnStatus").attr("value",b);$("#messageCode").attr("value",a);$("#quickpayForm").submit()}};function getVerifyCodeCountdown(a,b){if(a>0){a=a-1;if(b==0){$("#unboundGetVerifyCode").css("display","none");$("#unboundGetVerifyCodeUN").css("display","").text(a+"绉掑悗閲嶆柊鑾峰彇")}else{$("#boundGetVerifyCode").css("display","none");$("#boundGetVerifyCodeUN").css("display","").text(a+"绉掑悗閲嶆柊鑾峰彇")}getVerifyCodeTimeout=setTimeout("getVerifyCodeCountdown("+a+", "+b+")",1000)}else{clearTimeout(getVerifyCodeTimeout);if(b==0){$("#unboundGetVerifyCode").text("閲嶆柊鑾峰彇鐭俊楠岃瘉鐮�);$("#unboundGetVerifyCode").css("display","");$("#unboundGetVerifyCodeUN").css("display","none")}else{$("#boundGetVerifyCode").text("閲嶆柊鑾峰彇鐭俊楠岃瘉鐮�);$("#boundGetVerifyCode").css("display","");$("#boundGetVerifyCodeUN").css("display","none")}}}function quickpayConfirmCountdown(a,b){if(a>0){a=a-1;if(b==0){$("#unboundQuickpayConfirm").css("display","none");$("#unboundQuickpayConfirmUN").css("display","");$("#agree").attr("disabled","disabled")}else{$("#boundQuickpayConfirm").css("display","none");$("#boundQuickpayConfirmUN").css("display","")}$("#loading").css("display","").html("姝ｅ悜閾惰鎻愪氦浠樻锛岃绋嶅�鈥︹�");quickpayConfirmTimeout=setTimeout("quickpayConfirmCountdown("+a+", "+b+")",1000)}else{clearTimeout(quickpayConfirmTimeout);if(b==0){$("#unboundQuickpayConfirm").css("display","");$("#unboundQuickpayConfirmUN").css("display","none");$("#agree").attr("disabled","")}else{$("#boundQuickpayConfirm").css("display","");$("#boundQuickpayConfirmUN").css("display","none")}$("#loading").css("display","none").empty()}}function cardVerify(){var d=$("#cardNo").val();var c=$("#businessDataBase").val();var b={cardNo:d,businessDataBase:c};var a=prefix+"quickpay.jd.com/async/asyncCardVerify.action";$.post(a,b,e,"json");function e(f){if(f.resultCode=="success"){$("#cardNoTip").html("璇ュ崱鍙峰凡寮��蹇嵎鏀粯锛�a href='#' id='toPay' class='flk-05'>鍏嶅紑閫氱珛鍗冲幓鏀粯</a>");$("#toPay").bind("click",function(){$("#bankCode").attr("value","2&"+f.result.cardSecurityId);var g=prefix+"quickpay.jd.com/bindBankCard.action";$("#quickpayForm").attr("action",g);$("#quickpayForm").submit()})}else{}}}function getNotice(b){var c={key:b};var a=prefix+"quickpay.jd.com/async/asyncShowNotice.action";$.post(a,c,d,"json");function d(e){if(e.resultCode=="success"){if(e.result.content==undefined||e.result.content=="undefined"||e.result.content==""||e.result.content==null){$("#noticeArea").css("display","none")}else{$("#notice").html(e.result.content);$("#noticeArea").css("display","")}}else{$("#noticeArea").css("display","none")}}}function showErrorTip(b,a){if(a==1){$("#phoneVerifyCodeTip").text(b);$("#phoneVerifyCode").focus()}else{$("#quickpayConfirmTip").text(b);$("#quickpayConfirmTip").css("display","")}}$(document).keydown(function(a){if((a.altKey)&&((a.keyCode==37)||(a.keyCode==39))){a.returnValue=false;return false}if(a.keyCode==116){return false}if((a.ctrlKey)&&(a.keyCode==82)){return false}});$(document).ready(function(){(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=("https:"==document.location.protocol?"https://cscssl":"http://csc")+".jd.com/wl.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})()});